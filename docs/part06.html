<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>part06 – گزارش فاز دوم</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dab47b9ec171cea5432e28dc5cd2adcd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./pics/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">گزارش فاز دوم</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">خانه</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./part00.html"> 
<span class="menu-text">مقدمه</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./part01.html"> 
<span class="menu-text">طراحی اولیه</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./part02.html"> 
<span class="menu-text">جمع‌آوری داده شرکت‌ها</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./part03.html"> 
<span class="menu-text">نمونه‌گیری</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">نتایج</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="./part04.html">
 <span class="dropdown-text">نتیجه پرسش‌نامه</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./part06.html">
 <span class="dropdown-text">بخش تحلیلی</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./part05.html"> 
<span class="menu-text">نتیجه‌گیری</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">درباره گزارش</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part06.html">بخش تحلیلی</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">نتیجه پرسش‌نامه</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part06.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">بخش تحلیلی</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">در این بخش:</h2>
   
  <ul>
  <li><a href="#بخش-تحلیلی" id="toc-بخش-تحلیلی" class="nav-link active" data-scroll-target="#بخش-تحلیلی">بخش تحلیلی</a>
  <ul>
  <li><a href="#امتیاز-سنجهها" id="toc-امتیاز-سنجهها" class="nav-link" data-scroll-target="#امتیاز-سنجهها">امتیاز سنجه‌ها</a></li>
  <li><a href="#بخش-۲-رضایت-شغلی-و-تجربه-کاری" id="toc-بخش-۲-رضایت-شغلی-و-تجربه-کاری" class="nav-link" data-scroll-target="#بخش-۲-رضایت-شغلی-و-تجربه-کاری">بخش ۲: رضایت شغلی و تجربه کاری</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-جنس" id="toc-امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-جنس" class="nav-link" data-scroll-target="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-جنس">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب جنس</a></li>
  <li><a href="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-سن" id="toc-امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-سن">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-اندازه-شرکت">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب اندازه شرکت</a></li>
  </ul></li>
  <li><a href="#بخش-۳-تعادل-کار-و-زندگی" id="toc-بخش-۳-تعادل-کار-و-زندگی" class="nav-link" data-scroll-target="#بخش-۳-تعادل-کار-و-زندگی">بخش ۳: تعادل کار و زندگی</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-جنس" id="toc-امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-جنس" class="nav-link" data-scroll-target="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-جنس">امتیاز کلی تعادل کار و زندگی بر حسب جنس</a></li>
  <li><a href="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-سن" id="toc-امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-سن">امتیاز کلی تعادل کار و زندگی بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی تعادل کار و زندگی بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-اندازه-شرکت">امتیاز کلی تعادل کار و زندگی بر حسب اندازه شرکت</a></li>
  </ul></li>
  <li><a href="#بخش-۴-حقوق-و-مزایا" id="toc-بخش-۴-حقوق-و-مزایا" class="nav-link" data-scroll-target="#بخش-۴-حقوق-و-مزایا">بخش ۴: حقوق و مزایا</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-جنس" id="toc-امتیاز-کلی-حقوق-و-مزایا-بر-حسب-جنس" class="nav-link" data-scroll-target="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-جنس">امتیاز کلی حقوق و مزایا بر حسب جنس</a></li>
  <li><a href="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-سن" id="toc-امتیاز-کلی-حقوق-و-مزایا-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-سن">امتیاز کلی حقوق و مزایا بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-حقوق-و-مزایا-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی حقوق و مزایا بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-حقوق-و-مزایا-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-حقوق-و-مزایا-بر-حسب-اندازه-شرکت">امتیاز کلی حقوق و مزایا بر حسب اندازه شرکت</a></li>
  </ul></li>
  <li><a href="#بخش-۵-فرصتهای-رشد-و-آموزش" id="toc-بخش-۵-فرصتهای-رشد-و-آموزش" class="nav-link" data-scroll-target="#بخش-۵-فرصتهای-رشد-و-آموزش">بخش ۵: فرصت‌های رشد و آموزش</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-فرصتهای-رشد-و-آموزش" id="toc-امتیاز-کلی-فرصتهای-رشد-و-آموزش" class="nav-link" data-scroll-target="#امتیاز-کلی-فرصتهای-رشد-و-آموزش">امتیاز کلی فرصت‌های رشد و آموزش</a></li>
  <li><a href="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-سن" id="toc-امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-سن">امتیاز کلی فرصت‌های رشد و آموزش بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی فرصت‌های رشد و آموزش بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-اندازه-شرکت">امتیاز کلی فرصت‌های رشد و آموزش بر حسب اندازه شرکت</a></li>
  </ul></li>
  <li><a href="#بخش-۶-فرهنگ-سازمانی-و-محیط-کار" id="toc-بخش-۶-فرهنگ-سازمانی-و-محیط-کار" class="nav-link" data-scroll-target="#بخش-۶-فرهنگ-سازمانی-و-محیط-کار">بخش ۶: فرهنگ سازمانی و محیط کار</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-جنس" id="toc-امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-جنس" class="nav-link" data-scroll-target="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-جنس">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب جنس</a></li>
  <li><a href="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-سن" id="toc-امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-سن">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-اندازه-شرکت">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب اندازه شرکت</a></li>
  </ul></li>
  <li><a href="#بخش-۷-مدیریت-و-رهبری" id="toc-بخش-۷-مدیریت-و-رهبری" class="nav-link" data-scroll-target="#بخش-۷-مدیریت-و-رهبری">بخش ۷: مدیریت و رهبری</a>
  <ul class="collapse">
  <li><a href="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-جنس" id="toc-امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-جنس" class="nav-link" data-scroll-target="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-جنس">امتیاز کلی مدیریت و رهبری بر حسب جنس</a></li>
  <li><a href="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-سن" id="toc-امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-سن" class="nav-link" data-scroll-target="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-سن">امتیاز کلی مدیریت و رهبری بر حسب سن</a></li>
  <li><a href="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-دانشگاه-محل-تحصیل" id="toc-امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-دانشگاه-محل-تحصیل" class="nav-link" data-scroll-target="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی مدیریت و رهبری بر حسب دانشگاه محل تحصیل</a></li>
  <li><a href="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-اندازه-شرکت" id="toc-امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-اندازه-شرکت" class="nav-link" data-scroll-target="#امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-اندازه-شرکت">امتیاز کلی مدیریت و رهبری بر حسب اندازه شرکت</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="بخش-تحلیلی" class="level2">
<h2 class="anchored" data-anchor-id="بخش-تحلیلی">بخش تحلیلی</h2>
<div id="ef67ae9e-5f7a-4a71-b14e-fcd3dda900a6" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imports and functions</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arabic_reshaper</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bidi.algorithm <span class="im">import</span> get_display</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> font_manager, rc</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.colors <span class="im">as</span> mcolors</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter, defaultdict</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>COLORS <span class="op">=</span> {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"danger"</span>: <span class="st">"#e74c3c"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"warning"</span>: <span class="st">"#f39c12"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"primary"</span>: <span class="st">"#375a7f"</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"info"</span>: <span class="st">"#3498db"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"success"</span>: <span class="st">"#00bc8c"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"secondary"</span>: <span class="st">"#444"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"light"</span>: <span class="st">"#adb5bd"</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dark"</span>: <span class="st">"#303030"</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>SURVEY_ID <span class="op">=</span> <span class="st">"1617468"</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>BASE_SURVEY_URL <span class="op">=</span> <span class="st">"https://survey.porsline.ir"</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"psk.txt"</span>,<span class="st">'r'</span>) <span class="im">as</span> fh:</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    api_key <span class="op">=</span> fh.readline().strip()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>api_key_text <span class="op">=</span> <span class="ss">f"API-Key </span><span class="sc">{</span>api_key<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Authorization'</span>: api_key_text,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Content-Type'</span>: <span class="st">'application/json'</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> BASE_SURVEY_URL <span class="op">+</span> <span class="ss">f"/api/v2/surveys/</span><span class="sc">{</span>SURVEY_ID<span class="sc">}</span><span class="ss">/responses/results-table"</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.request(<span class="st">"GET"</span>, url, headers<span class="op">=</span>headers)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>n_responders <span class="op">=</span> <span class="bu">int</span>(response.json()[<span class="st">"responders_count"</span>])</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># تابع تبدیل متن فارسی</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_persian_text(text):</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    reshaped_text <span class="op">=</span> arabic_reshaper.reshape(text)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> get_display(reshaped_text)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># تنظیم فونت فارسی</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>font_path <span class="op">=</span> <span class="st">"fonts/xb-zar/Zar/XB Zar.ttf"</span>  <span class="co"># مسیر فونت  # مسیر فونت فارسی</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>prop <span class="op">=</span> font_manager.FontProperties(fname<span class="op">=</span>font_path)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>rc(<span class="st">'font'</span>, family<span class="op">=</span>prop.get_name())</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the excel file</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">'Phase02.xlsx'</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-Proccessing</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ======================================================================================================</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">## Size unification</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>ordered_company_sizes <span class="op">=</span> [</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">'کمتر از ۵۰ نفر'</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'۵۱ تا ۲۰۰ نفر'</span>,  <span class="co"># Combined category</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'۲۰۰ تا ۵۰۰ نفر'</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'بیش از ۵۰۰ نفر'</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>ordered_ages <span class="op">=</span> [</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">'کمتر از ۲۵ سال'</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">'۲۶ تا ۳۵ سال'</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">'۳۶ تا ۴۵ سال'</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">'بالای ۴۵ سال'</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping from the original size values to the desired order</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>size_mapping <span class="op">=</span> {</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    size: <span class="st">'۵۱ تا ۲۰۰ نفر'</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> size <span class="kw">in</span> df[<span class="st">'اندازه شرکت:'</span>].unique()</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'۵۱ تا ۱۰۰ نفر'</span> <span class="kw">in</span> size <span class="kw">or</span> <span class="st">'۱۰۱ تا ۲۰۰ نفر'</span> <span class="kw">in</span> size</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>size_mapping.update({</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    size: size</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> size <span class="kw">in</span> df[<span class="st">'اندازه شرکت:'</span>].unique()</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'کمتر از ۵۰ نفر'</span> <span class="kw">in</span> size <span class="kw">or</span> <span class="st">'۲۰۰ تا ۵۰۰ نفر'</span> <span class="kw">in</span> size <span class="kw">or</span> <span class="st">'بیش از ۵۰۰ نفر'</span> <span class="kw">in</span> size</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'اندازه شرکت:'</span>] <span class="op">=</span> df[<span class="st">'اندازه شرکت:'</span>].<span class="bu">map</span>(size_mapping)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">17</span>, <span class="st">'score_section_2'</span>, <span class="va">None</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">24</span>, <span class="st">'score_section_3'</span>, <span class="va">None</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">31</span>, <span class="st">'score_section_4'</span>, <span class="va">None</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">36</span>, <span class="st">'score_section_5'</span>, <span class="va">None</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">43</span>, <span class="st">'score_section_6'</span>, <span class="va">None</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">48</span>, <span class="st">'score_section_7'</span>, <span class="va">None</span>)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">54</span>, <span class="st">'score_section_8'</span>, <span class="va">None</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>QUESTIONS <span class="op">=</span> df.columns.tolist()</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>section2_answer_order <span class="op">=</span> [</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">'به هیچ وجه'</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">'کم'</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">'متوسط'</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">'زیاد'</span>,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">'خیلی زیاد'</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>section3_answer_order <span class="op">=</span> [</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">'خیلی مخالفم'</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">'مخالفم'</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">'تا حدودی'</span>,</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">'موافقم'</span>,</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"خیلی موافقم"</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>section6_answer_order <span class="op">=</span> [</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">'به هیچ وجه'</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">'کم'</span>,</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">'تا حدودی'</span>,</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">'زیاد'</span>,</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">'خیلی زیاد'</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Assiging Questions to each sections</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>section_2_questions <span class="op">=</span> [QUESTIONS[<span class="dv">11</span>], QUESTIONS[<span class="dv">12</span>],QUESTIONS[<span class="dv">13</span>],QUESTIONS[<span class="dv">14</span>],QUESTIONS[<span class="dv">15</span>],QUESTIONS[<span class="dv">16</span>]]</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>section_3_questions <span class="op">=</span> [QUESTIONS[<span class="dv">18</span>], QUESTIONS[<span class="dv">19</span>], QUESTIONS[<span class="dv">20</span>], QUESTIONS[<span class="dv">21</span>], QUESTIONS[<span class="dv">22</span>], QUESTIONS[<span class="dv">23</span>]]</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>section_4_questions <span class="op">=</span> [QUESTIONS[<span class="dv">25</span>], QUESTIONS[<span class="dv">26</span>], QUESTIONS[<span class="dv">27</span>], QUESTIONS[<span class="dv">28</span>], QUESTIONS[<span class="dv">29</span>], QUESTIONS[<span class="dv">30</span>]]</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>section_5_questions <span class="op">=</span> [QUESTIONS[<span class="dv">32</span>], QUESTIONS[<span class="dv">33</span>], QUESTIONS[<span class="dv">34</span>], QUESTIONS[<span class="dv">35</span>]]</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>section_6_questions <span class="op">=</span> [QUESTIONS[<span class="dv">37</span>], QUESTIONS[<span class="dv">38</span>], QUESTIONS[<span class="dv">39</span>], QUESTIONS[<span class="dv">40</span>], QUESTIONS[<span class="dv">41</span>], QUESTIONS[<span class="dv">42</span>]]</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>section_7_questions <span class="op">=</span> [QUESTIONS[<span class="dv">44</span>], QUESTIONS[<span class="dv">45</span>], QUESTIONS[<span class="dv">46</span>], QUESTIONS[<span class="dv">47</span>]]</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>section_8_questions <span class="op">=</span> [QUESTIONS[<span class="dv">49</span>], QUESTIONS[<span class="dv">50</span>], QUESTIONS[<span class="dv">51</span>], QUESTIONS[<span class="dv">52</span>], QUESTIONS[<span class="dv">53</span>]]</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>section_9_questions <span class="op">=</span> [QUESTIONS[<span class="dv">55</span>], QUESTIONS[<span class="dv">56</span>], QUESTIONS[<span class="dv">57</span>], QUESTIONS[<span class="dv">58</span>], QUESTIONS[<span class="dv">59</span>], QUESTIONS[<span class="dv">60</span>], QUESTIONS[<span class="dv">61</span>]]</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_section_score(df, question_cols, score_col, answer_order):</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    score_map <span class="op">=</span> {text: i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i, text <span class="kw">in</span> <span class="bu">enumerate</span>(answer_order)}</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map answers to scores column by column</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    numeric_answers <span class="op">=</span> df[question_cols].<span class="bu">apply</span>(<span class="kw">lambda</span> col: col.<span class="bu">map</span>(score_map))</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the row-wise average (skip NaNs)</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    df[score_col] <span class="op">=</span> numeric_answers.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    df[score_col] <span class="op">=</span> df[score_col].<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing scores for each section</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_2_questions, <span class="st">'score_section_2'</span> , section2_answer_order)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_3_questions, <span class="st">'score_section_3'</span> , section3_answer_order)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_4_questions, <span class="st">'score_section_4'</span> , section3_answer_order)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_5_questions, <span class="st">'score_section_5'</span> , section3_answer_order)</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_6_questions, <span class="st">'score_section_6'</span> , section6_answer_order)</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_7_questions, <span class="st">'score_section_7'</span> , section6_answer_order)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> compute_section_score(df, section_8_questions, <span class="st">'score_section_8'</span> , section6_answer_order)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> {</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"رضایت شغلی و تجربه کاری"</span> : df[<span class="st">'score_section_2'</span>].mean(),</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"تعادل کار و زندگی"</span> : df[<span class="st">'score_section_3'</span>].mean(),</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"حقوق و مزایا"</span> : df[<span class="st">'score_section_4'</span>].mean(),</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"فرصت‌های رشد و آموزش"</span> : df[<span class="st">'score_section_5'</span>].mean(),</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"فرهنگ سازمانی و محیط کار"</span> : df[<span class="st">'score_section_6'</span>].mean(),</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"مدیریت و رهبری"</span> : df[<span class="st">'score_section_7'</span>].mean(),</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"دیدگاه‌های کلان نسبت به سازمان"</span> : df[<span class="st">'score_section_8'</span>].mean()</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="co"># University mapping</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_university_map(filepath<span class="op">=</span><span class="st">"universities.json"</span>):</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> f:</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> json.load(f)</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_universities(df, column, uni_map, inplace<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    cleaned_series <span class="op">=</span> df[column].<span class="bu">str</span>.strip()</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    mapped <span class="op">=</span> cleaned_series.<span class="bu">map</span>(uni_map).fillna(<span class="st">"نامشخص"</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> inplace:</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>        df[column] <span class="op">=</span> mapped</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mapped</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>uni_map <span class="op">=</span> load_university_map()</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>classify_universities(df, QUESTIONS[<span class="dv">5</span>], uni_map)</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a><span class="co"># =======================================================================================================</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_builder(df, column_name, ordered_list<span class="op">=</span><span class="va">None</span>, colors<span class="op">=</span><span class="va">None</span>, title<span class="op">=</span><span class="va">None</span>, xlabel<span class="op">=</span><span class="va">None</span>, ylabel<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="co">    Generates a bar chart from a DataFrame column with optional ordering,</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a><span class="co">    coloring, and hatching, with automatic width adjustment.</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the column exists</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> column_name <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error: The column '</span><span class="sc">{</span>column_name<span class="sc">}</span><span class="ss">' does not exist in the DataFrame."</span>)</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ordered_list:</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>        value_mapping <span class="op">=</span> {</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>            value: ordered_value</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> ordered_value <span class="kw">in</span> ordered_list</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> value <span class="kw">in</span> df[column_name].unique()</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ordered_value <span class="op">==</span> value</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>        categorical_value <span class="op">=</span> pd.Categorical(df[column_name].<span class="bu">map</span>(value_mapping), categories<span class="op">=</span>ordered_list, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>        df_sorted <span class="op">=</span> df.assign(sorted_value<span class="op">=</span>categorical_value).sort_values(<span class="st">'sorted_value'</span>)</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>        unique_values_sorted <span class="op">=</span> df_sorted[<span class="st">'sorted_value'</span>].unique()</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>        counts_sorted <span class="op">=</span> df_sorted[<span class="st">'sorted_value'</span>].value_counts().reindex(ordered_list).fillna(<span class="dv">0</span>)</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>        x_labels <span class="op">=</span> [prepare_persian_text(val) <span class="cf">for</span> val <span class="kw">in</span> counts_sorted.index]</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>        counts_sorted <span class="op">=</span> df[column_name].value_counts()</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>        x_labels <span class="op">=</span> [prepare_persian_text(val) <span class="cf">for</span> val <span class="kw">in</span> counts_sorted.index]</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>        unique_values_sorted <span class="op">=</span> counts_sorted.index</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine colors and hatching</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    hatch_patterns <span class="op">=</span> [<span class="st">'/'</span>, <span class="st">'.'</span>, <span class="st">'o'</span>, <span class="va">None</span>]</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> colors:</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>        bar_colors <span class="op">=</span> [colors.get(val, COLORS[<span class="st">'dark'</span>]) <span class="cf">for</span> val <span class="kw">in</span> unique_values_sorted]</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>        bar_hatches <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> <span class="bu">len</span>(unique_values_sorted)</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>        default_color_list <span class="op">=</span> [COLORS[<span class="st">'primary'</span>], COLORS[<span class="st">'success'</span>], COLORS[<span class="st">'warning'</span>], COLORS[<span class="st">'danger'</span>], COLORS[<span class="st">'info'</span>]]</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>        bar_colors <span class="op">=</span> [default_color_list[i <span class="op">%</span> <span class="bu">len</span>(default_color_list)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(unique_values_sorted))]</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(unique_values_sorted) <span class="op">&gt;</span> <span class="bu">len</span>(default_color_list):</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>            bar_hatches <span class="op">=</span> [hatch_patterns[i <span class="op">%</span> <span class="bu">len</span>(hatch_patterns)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(unique_values_sorted))]</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>            bar_hatches <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> <span class="bu">len</span>(unique_values_sorted)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate figure width</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>    num_bars <span class="op">=</span> <span class="bu">len</span>(counts_sorted)</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    spacing <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    estimated_plot_width <span class="op">=</span> num_bars <span class="op">*</span> (bar_width <span class="op">+</span> spacing)</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    min_width <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    fig_width <span class="op">=</span> <span class="bu">max</span>(min_width, estimated_plot_width)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(fig_width, <span class="dv">6</span>))</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set dark background</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    fig.patch.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot bars</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (val, count) <span class="kw">in</span> <span class="bu">enumerate</span>(counts_sorted.items()):</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>        ax.bar(val, count,</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span>bar_colors[i],</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>               hatch<span class="op">=</span>bar_hatches[i],</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>               edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>               linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title and labels</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> title:</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>        ax.set_title(prepare_persian_text(title), color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> xlabel:</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(prepare_persian_text(xlabel), color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ylabel:</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(prepare_persian_text(ylabel), color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Counts above bars</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(counts_sorted.values)</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>, max_count <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, count <span class="kw">in</span> <span class="bu">enumerate</span>(counts_sorted.values):</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>        per <span class="op">=</span> <span class="bu">round</span>((count <span class="op">/</span> <span class="bu">sum</span>(counts_sorted)) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>        ax.text(counts_sorted.index[i],</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>                count <span class="op">+</span> max_count <span class="op">*</span> <span class="fl">0.02</span>,</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(count)<span class="sc">}</span><span class="ss">, (</span><span class="sc">{</span>per<span class="sc">}</span><span class="ss">%)"</span>,</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>,</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>    <span class="co"># X-axis labels and ticks</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>    ang <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> num_bars <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="dv">45</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(counts_sorted.index)))</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(x_labels, rotation<span class="op">=</span>ang, ha<span class="op">=</span><span class="st">'right'</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axis lines (spines)</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> spine <span class="kw">in</span> ax.spines.values():</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>        spine.set_edgecolor(<span class="st">'#adb5bd'</span>)</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_stacked_bar_chart_from_counts(</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    counts_dict,</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Stacked Bar Chart"</span>,</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"Category"</span>,</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"Count"</span>,</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>    max_labels<span class="op">=</span><span class="dv">10</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a><span class="co">    Generates stacked bar charts from a counts dictionary.</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="co">    Applies prepare_persian_text and uses custom colors with dark theme.</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>    farsi_priority <span class="op">=</span> [</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>        <span class="st">"اولویت اول"</span>, <span class="st">"اولویت دوم"</span>, <span class="st">"اولویت سوم"</span>, <span class="st">"اولویت چهارم"</span>,</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>        <span class="st">"اولویت پنجم"</span>, <span class="st">"اولویت ششم"</span>, <span class="st">"اولویت هفتم"</span>, <span class="st">"اولویت هشتم"</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>    farsi_labels <span class="op">=</span> [prepare_persian_text(label) <span class="cf">for</span> label <span class="kw">in</span> farsi_priority]</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare data</span></span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>    x_labels <span class="op">=</span> <span class="bu">list</span>(counts_dict.keys())</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter long x-labels</span></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(x_labels) <span class="op">&gt;</span> max_labels:</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>        filtered_keys <span class="op">=</span> x_labels[:max_labels]</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>        counts_dict_filtered <span class="op">=</span> {k: counts_dict[k] <span class="cf">for</span> k <span class="kw">in</span> filtered_keys}</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>        counts_dict_filtered[prepare_persian_text(<span class="st">'سایر'</span>)] <span class="op">=</span> {}</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> x_labels[max_labels:]:</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item, count <span class="kw">in</span> counts_dict[k].items():</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pd.notna(item):</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>                    counts_dict_filtered[prepare_persian_text(<span class="st">'سایر'</span>)][item] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>                        counts_dict_filtered[prepare_persian_text(<span class="st">'سایر'</span>)].get(item, <span class="dv">0</span>) <span class="op">+</span> count</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>        counts_dict <span class="op">=</span> counts_dict_filtered</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>        x_labels <span class="op">=</span> <span class="bu">list</span>(counts_dict.keys())</span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>        x_labels <span class="op">=</span> [prepare_persian_text(label) <span class="cf">for</span> label <span class="kw">in</span> x_labels]</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>    all_elements <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> counts <span class="kw">in</span> counts_dict.values():</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> element <span class="kw">in</span> counts.keys():</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.notna(element):</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>                all_elements.add(element)</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>    elements <span class="op">=</span> <span class="bu">sorted</span>(all_elements)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> colors <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>        default_color_list <span class="op">=</span> [</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>            COLORS[<span class="st">'primary'</span>], COLORS[<span class="st">'success'</span>], COLORS[<span class="st">'warning'</span>], COLORS[<span class="st">'danger'</span>],</span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>            COLORS.get(<span class="st">'purple'</span>, <span class="st">'purple'</span>), COLORS.get(<span class="st">'violet'</span>, <span class="st">'violet'</span>),</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>            COLORS[<span class="st">'info'</span>], COLORS.get(<span class="st">'olive'</span>, <span class="st">'olive'</span>)</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> {</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>            elements[i <span class="op">%</span> <span class="bu">len</span>(elements)]: default_color_list[i <span class="op">%</span> <span class="bu">len</span>(default_color_list)]</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(elements))</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot setup</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>    fig.patch.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>    bar_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(x_labels))</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> np.zeros(<span class="bu">len</span>(x_labels))</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j, element <span class="kw">in</span> <span class="bu">enumerate</span>(elements):</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>        heights <span class="op">=</span> [counts_dict.get(label, {}).get(element, <span class="dv">0</span>) <span class="cf">for</span> label <span class="kw">in</span> x_labels]</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>        bars <span class="op">=</span> ax.bar(</span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>            bar_positions,</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>            heights,</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>            bottom<span class="op">=</span>bottom,</span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>prepare_persian_text(element),</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colors.get(element, <span class="st">'gray'</span>),</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add text on bars</span></span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, bar <span class="kw">in</span> <span class="bu">enumerate</span>(bars):</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>            height <span class="op">=</span> bar.get_height()</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> height <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>                ax.text(</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>                    bar.get_x() <span class="op">+</span> bar.get_width() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>                    bar.get_y() <span class="op">+</span> height <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(height)<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>                    ha<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>                    va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">10</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">+=</span> np.array(heights)</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axes and labels</span></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(bar_positions)</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(farsi_labels[:<span class="bu">len</span>(bar_positions)], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(prepare_persian_text(xlabel), fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(prepare_persian_text(ylabel), fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>    ax.set_title(prepare_persian_text(title), fontsize<span class="op">=</span><span class="dv">14</span>, color<span class="op">=</span><span class="st">'white'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grid and spines</span></span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>    ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#adb5bd'</span>)</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> spine <span class="kw">in</span> ax.spines.values():</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>        spine.set_edgecolor(<span class="st">'#adb5bd'</span>)</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legend</span></span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span>prepare_persian_text(<span class="st">"دسته‌ها"</span>),</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>        title_fontsize<span class="op">=</span><span class="dv">11</span>,</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>        labelcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>        facecolor<span class="op">=</span><span class="st">'#303030'</span>,</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">'upper left'</span>,</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>        bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>)</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> column_elemnt_counter (df, hdr):</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>    column_name<span class="op">=</span> hdr</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>    separator <span class="op">=</span> <span class="st">"،"</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>    new_data <span class="op">=</span> []</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    max_items <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>        items <span class="op">=</span> <span class="bu">str</span>(row[column_name]).split(separator)</span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>        items <span class="op">=</span> [item.strip() <span class="cf">for</span> item <span class="kw">in</span> items]</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>        new_data.append(items)</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>        max_items <span class="op">=</span> <span class="bu">max</span>(max_items, <span class="bu">len</span>(items))</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>        new_df <span class="op">=</span> pd.DataFrame(new_data)</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>        new_df.columns <span class="op">=</span> [<span class="ss">f'priority</span><span class="sc">{</span><span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>)<span class="sc">.</span>zfill(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(max_items)] <span class="co"># Create column name</span></span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    column_element_counts <span class="op">=</span> {}</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> new_df.columns:</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>            new_df[col] <span class="op">=</span> new_df[col].replace(<span class="st">'nan'</span>, <span class="va">None</span>)</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use value_counts() with dropna=False to include NaN counts</span></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>            counts <span class="op">=</span> new_df[col].value_counts(dropna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert to dictionary, handling potential type issues in keys</span></span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>            column_element_counts[col] <span class="op">=</span> {<span class="bu">str</span>(k): <span class="bu">int</span>(v) <span class="cf">for</span> k, v <span class="kw">in</span> counts.items()} </span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"TypeError encountered in column '</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Handle the error appropriately, e.g., skip the column or use a default</span></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>            column_element_counts[col] <span class="op">=</span> {}  <span class="co"># Or some other default</span></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"An unexpected error occurred in column '</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>            column_element_counts[col] <span class="op">=</span> {}  <span class="co"># Or some other default</span></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> column_element_counts</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_responses_by_category(</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>    category_col,</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>    question_col,</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>    ordered_list<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>    COLORS<span class="op">=</span>COLORS,</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>    percent<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group counts</span></span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>    count_df <span class="op">=</span> df.groupby([category_col, question_col]).size().unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reorder columns if ordered_list is provided</span></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ordered_list:</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>        count_df <span class="op">=</span> count_df[[col <span class="cf">for</span> col <span class="kw">in</span> ordered_list <span class="cf">if</span> col <span class="kw">in</span> count_df.columns]]</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reorder index (categories) if category_sort is provided</span></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> category_sort:</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>        count_df <span class="op">=</span> count_df.reindex([cat <span class="cf">for</span> cat <span class="kw">in</span> category_sort <span class="cf">if</span> cat <span class="kw">in</span> count_df.index])</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to percent if needed</span></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> percent:</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a>        count_df <span class="op">=</span> count_df.div(count_df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare texts</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>    count_df.index <span class="op">=</span> [prepare_persian_text(<span class="bu">str</span>(idx)) <span class="cf">for</span> idx <span class="kw">in</span> count_df.index]</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a>    count_df.columns <span class="op">=</span> [prepare_persian_text(<span class="bu">str</span>(col)) <span class="cf">for</span> col <span class="kw">in</span> count_df.columns]</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot sizing</span></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>    num_categories <span class="op">=</span> count_df.shape[<span class="dv">0</span>]</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>    spacing <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>    estimated_width <span class="op">=</span> num_categories <span class="op">*</span> (bar_width <span class="op">+</span> spacing)</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>    fig_width <span class="op">=</span> <span class="bu">max</span>(<span class="dv">8</span>, estimated_width)</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create figure and set background</span></span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(fig_width, <span class="dv">6</span>))</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>    fig.patch.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define colors</span></span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>    n_bars <span class="op">=</span> <span class="bu">len</span>(count_df.columns)</span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>    color_list <span class="op">=</span> <span class="bu">list</span>(COLORS.values()) <span class="cf">if</span> COLORS <span class="cf">else</span> []</span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_bars <span class="op">&gt;</span> <span class="bu">len</span>(color_list):</span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>        extra_colors <span class="op">=</span> <span class="bu">list</span>(cm.Set2.colors)</span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>        color_list <span class="op">+=</span> extra_colors[:n_bars <span class="op">-</span> <span class="bu">len</span>(color_list)]</span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>    bar_colors <span class="op">=</span> color_list[:n_bars]</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot</span></span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>    count_df.plot(</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a>        kind<span class="op">=</span><span class="st">'bar'</span>,</span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>        stacked<span class="op">=</span>percent,</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>bar_colors,</span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span>bar_width,</span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title</span></span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> title:</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>        ax.set_title(</span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>            prepare_persian_text(title),</span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">16</span>,</span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a>            pad<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span></span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axis labels</span></span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> xlabel:</span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(</span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a>            prepare_persian_text(xlabel),</span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a>            labelpad<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span></span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ylabel:</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> ylabel <span class="cf">if</span> ylabel <span class="cf">else</span> (<span class="st">'درصد'</span> <span class="cf">if</span> percent <span class="cf">else</span> <span class="st">'تعداد'</span>)</span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(</span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>            prepare_persian_text(label),</span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>            labelpad<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span></span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(count_df) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a>        angle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a>        angle <span class="op">=</span> <span class="dv">45</span></span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tick styling</span></span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(count_df.index)))</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(count_df.index, rotation<span class="op">=</span>angle, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Label bars</span></span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a>    max_val <span class="op">=</span> count_df.values.<span class="bu">max</span>()</span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> container <span class="kw">in</span> ax.containers:</span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>        ax.bar_label(</span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a>            container,</span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'</span><span class="sc">%.1f%%</span><span class="st">'</span> <span class="cf">if</span> percent <span class="cf">else</span> <span class="st">'%.0f'</span>,</span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a>            label_type<span class="op">=</span><span class="st">'edge'</span>,</span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>            padding<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span></span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust spacing</span></span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>, max_val <span class="op">*</span> <span class="fl">1.15</span>)</span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set spine and axis line colors</span></span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> spine <span class="kw">in</span> ax.spines.values():</span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>        spine.set_edgecolor(<span class="st">'#adb5bd'</span>)</span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legend outside</span></span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span>prepare_persian_text(<span class="st">'پاسخ'</span>),</span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>        bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">'upper left'</span>,</span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>        borderaxespad<span class="op">=</span><span class="fl">0.</span>,</span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a>        facecolor<span class="op">=</span><span class="st">'#303030'</span>,</span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a>        labelcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>        title_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">10</span></span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(right<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_score_hist_by_category(</span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>    category_col,</span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>    score_col,</span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>    COLORS<span class="op">=</span>COLORS,</span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a><span class="co">    Plots histograms of a numeric score column with one subplot per category.</span></span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a><span class="co">    Includes mean/median lines, bar labels, and extra summary info box.</span></span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine categories</span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>    categories <span class="op">=</span> df[category_col].dropna().unique()</span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> category_sort:</span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> [cat <span class="cf">for</span> cat <span class="kw">in</span> category_sort <span class="cf">if</span> cat <span class="kw">in</span> categories]</span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> <span class="bu">sorted</span>(categories)</span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a>    n_cats <span class="op">=</span> <span class="bu">len</span>(categories)</span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(n_cats, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span> <span class="op">*</span> n_cats), sharex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a>    fig.patch.set_facecolor(<span class="st">'#303030'</span>)  <span class="co"># Dark background</span></span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_cats <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>        axes <span class="op">=</span> [axes]</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a>    fallback_colors <span class="op">=</span> <span class="bu">list</span>(cm.Set2.colors)</span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>    min_score <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a>    bin_edges <span class="op">=</span> np.linspace(min_score, max_score, bins <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(categories):</span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[i]</span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>        ax.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[df[category_col] <span class="op">==</span> cat][score_col].dropna()</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> COLORS.get(cat, fallback_colors[i <span class="op">%</span> <span class="bu">len</span>(fallback_colors)]) <span class="cf">if</span> COLORS <span class="cf">else</span> fallback_colors[i <span class="op">%</span> <span class="bu">len</span>(fallback_colors)]</span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Histogram with border</span></span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>        counts, bins_edges, patches <span class="op">=</span> ax.hist(</span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>            subset,</span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>            bins<span class="op">=</span>bin_edges,</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span>,</span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a>            alpha<span class="op">=</span><span class="fl">0.85</span></span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Stats</span></span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a>        mean_val <span class="op">=</span> subset.mean()</span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a>        median <span class="op">=</span> subset.median()</span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a>        greater_than_mean <span class="op">=</span> (subset <span class="op">&gt;</span> mean_val).<span class="bu">sum</span>()</span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a>        less_than_mean <span class="op">=</span> (subset <span class="op">&lt;</span> mean_val).<span class="bu">sum</span>()</span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lines</span></span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a>        ax.axvline(mean_val, color<span class="op">=</span>COLORS[<span class="st">'info'</span>], linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a>        ax.axvline(median, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Legend</span></span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>        legend_elements <span class="op">=</span> [</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a>            Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span>COLORS[<span class="st">'info'</span>], linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>prepare_persian_text(<span class="st">'میانگین'</span>)<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>mean_val<span class="sc">:.3f}</span><span class="ss">"</span>),</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a>            Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>prepare_persian_text(<span class="st">'میانه'</span>)<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>median<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>        ax.legend(</span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a>            handles<span class="op">=</span>legend_elements,</span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a>            loc<span class="op">=</span><span class="st">'upper left'</span>,</span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>            bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>),</span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a>            borderaxespad<span class="op">=</span><span class="fl">0.</span>,</span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a>            labelcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a>            facecolor<span class="op">=</span><span class="st">'#303030'</span>,</span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">'#adb5bd'</span></span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Text box with Cm_bar⁺ / Cm_bar⁻</span></span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a>        fig.text(</span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>            <span class="fl">1.03</span>,                     <span class="co"># Right side</span></span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.85</span> <span class="op">-</span> (<span class="dv">1</span> <span class="op">/</span> <span class="bu">len</span>(categories)) <span class="op">*</span> i,          <span class="co"># Dynamic vertical placement</span></span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>            prepare_persian_text(</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"Cm_bar⁺: </span><span class="sc">{</span>greater_than_mean<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"Cm_bar⁻: </span><span class="sc">{</span>less_than_mean<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>            family<span class="op">=</span><span class="st">'sans-serif'</span></span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add bar labels</span></span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> rect, count <span class="kw">in</span> <span class="bu">zip</span>(patches, counts):</span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a>                ax.text(</span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a>                    rect.get_x() <span class="op">+</span> rect.get_width() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a>                    rect.get_height(),</span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(count)<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a>                    ha<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a>                    va<span class="op">=</span><span class="st">'bottom'</span>,</span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">'white'</span></span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Labels, grid, styling</span></span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a>        ax.set_title(prepare_persian_text(<span class="bu">str</span>(cat)), fontsize<span class="op">=</span><span class="dv">14</span>, pad<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(prepare_persian_text(ylabel <span class="cf">if</span> ylabel <span class="cf">else</span> <span class="st">'تعداد'</span>), fontsize<span class="op">=</span><span class="dv">12</span>, labelpad<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>        ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>        ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(min_score <span class="op">-</span> <span class="fl">0.2</span>, max_score <span class="op">+</span> <span class="fl">0.2</span>)</span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>        ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#adb5bd'</span>)</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a>        ax.grid(axis<span class="op">=</span><span class="st">'x'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#adb5bd'</span>)</span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> spine <span class="kw">in</span> ax.spines.values():</span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a>            spine.set_edgecolor(<span class="st">'#adb5bd'</span>)</span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shared title</span></span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> title:</span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(prepare_persian_text(title), fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">1.005</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> xlabel:</span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>        fig.text(<span class="fl">0.5</span>, <span class="fl">0.025</span>, prepare_persian_text(xlabel), ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.94</span>, bottom<span class="op">=</span><span class="fl">0.06</span>, left<span class="op">=</span><span class="fl">0.08</span>, right<span class="op">=</span><span class="fl">0.95</span>, hspace<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="امتیاز-سنجهها" class="level3">
<h3 class="anchored" data-anchor-id="امتیاز-سنجهها">امتیاز سنجه‌ها</h3>
<p>پرسش‌نامه به جز دو بخش اول و آخر، ۷ بخش داشت. در هر بخش پرسش‌های خاصی پرسیده شده بود که منشارکت‌کنندگان بر اساس طیف لیکرت به آن پاسخ می‌دادند. حال برای تحلیل وضعیت هر کدام از سنجه‌هایی که در این بخش‌ها مورد پرسش قرار گرفته‌اند، به طریق زیر عمل می‌کنیم:</p>
<p>برای هر فرد، پاسخ‌هایی را که به پرسش‌ها داده است از ۱ تا ۵ (۱ کمترین و ۵ بیشترین) نمره می‌دهیم. سپس برای هر بخش میانگین نمره‌ای را که هر فرد داده است محاسبه و گزارش می‌کنیم. این عدد امتیاز یک مشارکت‌کننده به سنجه آن بخش در شرکت خود است.</p>
<p>حال می‌توان از این امتیازها در میان مشارکت‌کنندگان مختلف میانگین گرفت و چشم‌اندازی از وضعیت این سنجه در میان تمامی مشارکت‌کنندگان به دست آورد.</p>
<div id="62a4de75-f5d2-4f5e-9fa9-8af86353f5a9" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_section_mean_scores(scores_dict, title<span class="op">=</span><span class="st">"میانگین امتیاز هر بخش"</span>):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Plots a horizontal bar chart of mean scores for each section.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">        scores_dict (dict): Keys are section titles, values are mean scores.</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">        title (str): Title of the plot (in Persian).</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort the dictionary (optional: from highest to lowest)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    sorted_items <span class="op">=</span> <span class="bu">sorted</span>(scores_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [prepare_persian_text(k) <span class="cf">for</span> k, v <span class="kw">in</span> sorted_items]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> [v <span class="cf">for</span> k, v <span class="kw">in</span> sorted_items]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="bu">len</span>(scores_dict) <span class="op">*</span> <span class="fl">0.8</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    fig.patch.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#303030'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose a consistent color from your COLORS dict or fallback</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    bar_colors <span class="op">=</span> [COLORS.get(<span class="st">'info'</span>, <span class="st">'#4dabf7'</span>)] <span class="op">*</span> <span class="bu">len</span>(values)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    bars <span class="op">=</span> ax.barh(labels, values, color<span class="op">=</span>bar_colors, edgecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value labels on bars</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bar, val <span class="kw">in</span> <span class="bu">zip</span>(bars, values):</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        ax.text(val <span class="op">+</span> <span class="fl">0.05</span>, bar.get_y() <span class="op">+</span> bar.get_height() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>val<span class="sc">:.2f}</span><span class="ss">"</span>, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'left'</span>, color<span class="op">=</span><span class="st">'white'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title and axis</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    ax.set_title(prepare_persian_text(title), fontsize<span class="op">=</span><span class="dv">14</span>, color<span class="op">=</span><span class="st">'white'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(prepare_persian_text(<span class="st">"میانگین امتیاز"</span>), fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="dv">0</span>, <span class="fl">5.5</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Styling</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> spine <span class="kw">in</span> ax.spines.values():</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        spine.set_edgecolor(<span class="st">'#adb5bd'</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    ax.grid(axis<span class="op">=</span><span class="st">'x'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#adb5bd'</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>plot_section_mean_scores(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>می‌توان دید که مشارکت‌کنندگان بیش از هر چیز ار شغل و تجربه کاری خود راضی هستند. یعنی شرکت‌ها عموما توانسته‌اند فرد مناسبی را برای جایگاه مناسبی انتخاب کنند و کارهای مناسبی به وی بسپارند و به درستی قدردان وی باشند.</p>
<p>همین طور شرکت‌ها توانسته‌اند هم تصویر خوبی از خود ارائه دهند و اهداف و استراتژی‌های سازمان را برای کارکنان خود روشن سازند، هم محیط تقریبا مناسبی برای مشارکت‌کنندگان به وجود آورند.</p>
<p>از سوی دیگر، مشارکت‌کنندگان از حقوق و مزایای خود ناراضی هستند. نه تنها میزان رضایت کمتری ابراز کرده‌اند، بلکه اختلاف معناداری هم با بیشتر رضایت ابرازشده دارد. یعنی هرچند که از شغل خود راضی هستند، فکر نمی‌کنند که در مقابل کاری که انجام می‌دهند دستمزد منصفانه‌ای می‌گیرند که در مقابل دیگر شرکت‌ها رقابتی است.</p>
<p>از آن جایی که بسیاری از مشارکت‌کنندگان در سال گذشته پیشنهاد شغلی دیگری نیز داشته‌اند، این نارضایتی از دستمزد می‌تواند عاملی برای ترک شرکت شود.</p>
<p>همین طور به نظر مشارکت‌کنندگان می‌رسد که فرصت‌های رشد و آموزش به قدر کافی برایشان رضایت‌بخش نیست. سهم زیادی از این نارضایتی در عدم شفافیت مسیر رشد و ارتقا نهفته است.</p>
<p>بر حسب دسته‌بندی‌های مختلف، مانند جنس، سن، محل تحصیل و اندازه شرکت می‌توان نمودارهای تغییرات امتیاز را رسم کرد و دید که چگونه در هر دسته با دیگر دسته‌ها متفاوت می‌شود. در این شکل تحلیل، که نمودارهای آن در ادامه رسم شده‌اند، دو خط کمکی میانگین و میانه هم به نمودار اضافه گشته است. در هر نمودار نسبت این دو خط با یکدیگر سه وضعیت می‌تواند داشته باشد:</p>
<ul>
<li>میانگین در سمت راست میانه قرار داشته باشد: در این صورت، سهم امتیازهای بالا در شکل دادن به آن نمودار بیشتر بوده است. بنابراین یا تعداد امتیازهای بالا بیشتر بوده یا اگر تعداد بیشتری نداشته‌اند، مجموع امتیازها بیشتر بوده، یعنی تعداد کمتری امتیازهای بالاتری داده‌اند. پس میزان <strong>رضایت</strong> از آن سنجه در آن دسته بالاست.</li>
<li>میانگین و میانه در فاصله بسیار نزدیکی از هم قرار دارند یا بر هم منطبق هستند: یا اختلاف نظر شدیدی میان مشارکت‌کنندگان آن دسته وجود دارد (که نظر هم را خنثی می‌کنند) یا تجربه مشارکت‌کنندگان شبیه به یکدیگر و در میانه راه است، حالتی که گویای وضعیتی مبهم و بلاتکلیف می‌تواند باشد.</li>
<li>میانگین در سمت چپ میانه قرار داشته باشد: در این صورت، سهم امتیازهای پایین در شکل دادن به آن نمودار بیشتر بوده است. بنابراین یا تعداد امتیازهای پایین بیشتر بوده یا اگر تعداد بیشتری نداشته، مجموعه امتیازهای پایین بیشتر بوده، یعنی تعداد کمتری از افراد، امتیازهای خیلی پایین داده‌اند. پس میزان <strong>نارضایتی</strong> در آن دسته بالاست.</li>
</ul>
<p>دو عدد هم در هر نمودار محاسبه شده است. تعداد اعدادی را که از میانگین بزرگ‌تر و کوچک‌تر بوده‌اند در کنار هر نمودار محاسبه کرده و نمایش داده‌ایم. این دو عدد وضعیت میانگین و میانه را که شرح دادیم، روشن‌تر نشان می‌دهند.</p>
</section>
<section id="بخش-۲-رضایت-شغلی-و-تجربه-کاری" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۲-رضایت-شغلی-و-تجربه-کاری">بخش ۲: رضایت شغلی و تجربه کاری</h3>
<p>نمودارهای این بخش نشان می‌دهند که زنان کمتر از مردان از شغلشان راضی هستند. همین طور اگر افراد بالای ۴۵ سال را (به دلیل کم‌تعداد بودن) کنار بگذاریم، با افزایش سن رضایت شغلی کم می‌شود. اما در بازه سنی ۳۶ تا ۴۵ سال، نمودار شکل جالبی به خود گرفته است. تعداد کسانی که امتیاز بالایی به این بخش داده‌اند به طور ناگهانی زیاد می‌شود. فارغ‌التحصیل‌های دانشگاه‌های آزاد ناراضی‌تر هستند و هر چقدر شرکت بزرگ‌تر می‌شود، نارضایتی از شغل بیشتر و تجربه کاری ناخوشایندتر می‌شود.</p>
<section id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-جنس" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-جنس">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب جنس</h4>
<div id="d549c3ec-42cd-42b3-979d-e350e2f2c389" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_2'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی رضایت شغلی و تجربه کاری بر حسب جنس'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-سن">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب سن</h4>
<div id="9d2c7d92-f1a2-446e-a13d-8b6607d6d5e3" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_2'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی رضایت شغلی و تجربه کاری بر حسب سن'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب دانشگاه محل تحصیل</h4>
<div id="aa9403cd-552a-4f06-8888-8fa63e013602" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_2'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی رضایت شغلی و تجربه کاری بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-رضایت-شغلی-و-تجربه-کاری-بر-حسب-اندازه-شرکت">امتیاز کلی رضایت شغلی و تجربه کاری بر حسب اندازه شرکت</h4>
<div id="b6593481-771a-4347-9b5d-8729ec26dbad" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_2'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی رضایت شغلی و تجربه کاری بر حسب اندازه شرکت'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="بخش-۳-تعادل-کار-و-زندگی" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۳-تعادل-کار-و-زندگی">بخش ۳: تعادل کار و زندگی</h3>
<section id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-جنس" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-جنس">امتیاز کلی تعادل کار و زندگی بر حسب جنس</h4>
<p>با توجه به این که اختلاف تعداد زنان و مردان قابل توجه نیست، اختلاف میانگین امتیاز به سنجه تعادل کار و زندگی را می‌توان به نارضایتی بیشتر زنان از این سنجه نسبت داد. یعنی تجربه زنان مشارکت‌کننده از کار، شرایط نامتعادل‌تری نسبت به مردان بوده است. نمودارهای سنی بر نارضایتی عمومی صحه می‌گذارند ولی نمودارهای مربوط به دانشگاه محل تحصیل نشان می‌دهند که فارغ‌التحصیلان دانشگاه‌های مختلف، انتظارهای گوناگونی از تعادل کار و زندگی ندارند. مساله تعادل کار و زندگی در شرکت‌های زیر ۵۰ نفر بهتر از باقی شرکت‌ها ارزیابی شده است و هر چقدر شرکت بزرگ‌تر می‌شود این تعادل به هم می‌خورد؛ در حالی که به طور شهودی باید غیر از این باشد و تقسیم کار در شرکت‌های بزرگ‌تر باید بتواند این تعادل را برقرار کند. اما چنان که از نمودارها پیداست، در شرکت‌های بزرگ نارضایتی از این عامل بسیار زیاد است.</p>
<div id="82a5d7b9-e09b-4a13-a49a-ede177b7418c" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_3'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی تعادل کار و زندگی بر حسب جنس'</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-سن">امتیاز کلی تعادل کار و زندگی بر حسب سن</h4>
<div id="b7d74c62-8a20-4c42-a900-a8f7d2444bdc" class="cell" data-scrolled="true" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_3'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی تعادل کار و زندگی بر حسب سن'</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی تعادل کار و زندگی بر حسب دانشگاه محل تحصیل</h4>
<div id="46ff1c51-d79a-43aa-90d7-598496b01c89" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_3'</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی تعادل کار و زندگی بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-تعادل-کار-و-زندگی-بر-حسب-اندازه-شرکت">امتیاز کلی تعادل کار و زندگی بر حسب اندازه شرکت</h4>
<div id="6b88e137-9cf3-448f-b336-eca4343468e5" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_3'</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی تعادل کار و زندگی بر حسب اندازه شرکت'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="بخش-۴-حقوق-و-مزایا" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۴-حقوق-و-مزایا">بخش ۴: حقوق و مزایا</h3>
<p>زنان به وضوح از حقوق و مزایای دریافتی خود ناراضی‌تر از مردان هستند. با توجه به تعداد تقریبا برابر زنان و مردان و شکل نمودار، زنان از حقوق و مزایای دریافتی خود بسیار ناراضی‌تر از مردان هستند. همین طور با بالاتر رفتن سن، نارضایتی از حقوق و مزایای دریافتی افزایش می‌یابد. فارغ‌التحصیلان دانشگاه‌های آزاد نسبت به این سنجه ناراضی‌تر از دیگر دانشگاه‌ها هستند و با بزرگ‌تر شدن اندازه شرکت، نارضایتی از حقوق و مزایای دریافتی هم افزایش می‌یابد.</p>
<section id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-جنس" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-جنس">امتیاز کلی حقوق و مزایا بر حسب جنس</h4>
<div id="4ac15df7-e951-4ac0-9f2f-0c6e1b008b4c" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_4'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی حقوق و مزایا بر حسب جنس'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-سن">امتیاز کلی حقوق و مزایا بر حسب سن</h4>
<div id="b137f3fe-b2d4-44ae-a963-573141b851bd" class="cell" data-scrolled="true" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_4'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی حقوق و مزایا بر حسب سن'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی حقوق و مزایا بر حسب دانشگاه محل تحصیل</h4>
<div id="5fe2d1e6-547c-434c-9e62-2df8df65c51e" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_4'</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی حقوق و مزایا بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-حقوق-و-مزایا-بر-حسب-اندازه-شرکت">امتیاز کلی حقوق و مزایا بر حسب اندازه شرکت</h4>
<div id="a72ad409-f7c3-4e7e-8719-26ba8372c14c" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_4'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی حقوق و مزایا بر حسب اندازه شرکت'</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="بخش-۵-فرصتهای-رشد-و-آموزش" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۵-فرصتهای-رشد-و-آموزش">بخش ۵: فرصت‌های رشد و آموزش</h3>
<p>در مورد این سنجه نیز زنان تجربه ناخوشایندتری را گزارش کرده‌اند. یعنی در نظر آنان فرصت‌های رشد و آموزش در کار به قدر کافی فراهم نیست. اگر چه مردان هم از فرصت‌های آموزش و رشدی که در اختیارشان قرار دارد راضی نیستند، اما به نظر می‌رسد که این فرصت‌ها برایشان رضایت بیشتری فراهم می‌کند. رضایت از فرصت‌های رشد و آموزش با بالا رفتن سن کاهش می‌یابد که به خودی خودی لزوما شگفت‌انگیز نیست. زیرا می‌تواند به اشباع جایگاه‌های رشد نیز تعبیر شود. با این حال، کاهش فرصت‌های رشد و آموزش در کنار کاهش رضایت از درآمد همراه با افزایش سن قابل تامل است. باز هم جالب است که با افزایش اندازه شرکت، رضایت از فرصت‌های رشد و آموزش کم می‌شود. گویی هر قدر شرکت‌ها بزرگ‌تر می‌شوند، افراد بر خلاف انتظارشان در جایگاه‌های خود ثابت می‌مانند و آن طور که انتظار دارند رشد نمی‌کنند.</p>
<section id="امتیاز-کلی-فرصتهای-رشد-و-آموزش" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرصتهای-رشد-و-آموزش">امتیاز کلی فرصت‌های رشد و آموزش</h4>
<div id="f3d88f9e-30c3-47ad-ae7d-e7626946cb07" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_5'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرصت‌های رشد و آموزش بر حسب جنس'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-سن">امتیاز کلی فرصت‌های رشد و آموزش بر حسب سن</h4>
<div id="7a739870-f30b-4179-ade7-c9d99b43ad02" class="cell" data-scrolled="true" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_5'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرصت‌های رشد و آموزش بر حسب سن'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی فرصت‌های رشد و آموزش بر حسب دانشگاه محل تحصیل</h4>
<div id="d7cb9ffc-700d-4950-aa82-1e91cb21ddec" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_5'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرصت‌های رشد و آموزش بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرصتهای-رشد-و-آموزش-بر-حسب-اندازه-شرکت">امتیاز کلی فرصت‌های رشد و آموزش بر حسب اندازه شرکت</h4>
<div id="e73727af-f53b-46d7-adb8-e0b1a987f984" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_5'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرصت‌های رشد و آموزش بر حسب اندازه شرکت'</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="بخش-۶-فرهنگ-سازمانی-و-محیط-کار" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۶-فرهنگ-سازمانی-و-محیط-کار">بخش ۶: فرهنگ سازمانی و محیط کار</h3>
<p>زنان از فرهنگ سازمانی و محیط کار خود رضایت کمتری از مردان دارند. با بالا رفتن سن هم رضایت از فرهنگ سازمانی و محیط کار کمتر می‌شود گویی سازمان کمتر می‌تواند انتظارات کارکنانش را از محیط کار برآورده سازد. هر چه سازمان بزرگ‌تر می‌شود هم کارکنان از فرهنگ سازمان و محیط کار خود ناراضی‌تر می‌شوند.</p>
<section id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-جنس" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-جنس">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب جنس</h4>
<div id="d0049e17-5168-4263-9f44-3d5dca70738d" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_6'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب جنس'</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-سن">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب سن</h4>
<div id="ae439e66-c249-471e-bf94-0b1cb6e81f52" class="cell" data-scrolled="true" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_6'</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب سن'</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب دانشگاه محل تحصیل</h4>
<div id="18da46dc-0912-46be-b268-4680cdd37eb5" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_6'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-فرهنگ-سازمانی-و-محیط-کار-بر-حسب-اندازه-شرکت">امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب اندازه شرکت</h4>
<div id="dd8e4139-ce91-4b60-a2b4-41c86ee346be" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_6'</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی فرهنگ سازمانی و محیط کار بر حسب اندازه شرکت'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="بخش-۷-مدیریت-و-رهبری" class="level3">
<h3 class="anchored" data-anchor-id="بخش-۷-مدیریت-و-رهبری">بخش ۷: مدیریت و رهبری</h3>
<p>اختلاف میان زنان و مردان در این مورد کمتر از موارد قبلی است و هر دو گروه تقریبا نظراتی شبیه هم دارند. اما الگوهای قبلی درباره سن و اندازه شرکت تکرار می‌شود، یعنی با افزایش آن‌ها، رضایت کاهش می‌یابد و روابط با مدیران تیره‌تر می‌گردد.</p>
<section id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-جنس" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-جنس">امتیاز کلی مدیریت و رهبری بر حسب جنس</h4>
<div id="f32912c1-98eb-4c0a-b1bb-d29ff247bbac" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">0</span>],</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_7'</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی مدیریت و رهبری بر حسب جنس'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span><span class="va">None</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-سن" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-سن">امتیاز کلی مدیریت و رهبری بر حسب سن</h4>
<div id="37e36e61-7293-453a-824d-f44b15c3ccdf" class="cell" data-scrolled="true" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">1</span>],</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_7'</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی مدیریت و رهبری بر حسب سن'</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_ages</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-دانشگاه-محل-تحصیل" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-دانشگاه-محل-تحصیل">امتیاز کلی مدیریت و رهبری بر حسب دانشگاه محل تحصیل</h4>
<div id="053d52de-708b-44d3-8623-99ad404d72d2" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">5</span>],</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_7'</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی مدیریت و رهبری بر حسب دانشگاه محل تحصیل'</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-اندازه-شرکت" class="level4">
<h4 class="anchored" data-anchor-id="امتیاز-کلی-مدیریت-و-رهبری-بر-حسب-اندازه-شرکت">امتیاز کلی مدیریت و رهبری بر حسب اندازه شرکت</h4>
<div id="467ebc03-b949-4393-89dd-be63ff12ac75" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plot_score_hist_by_category(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    QUESTIONS[<span class="dv">10</span>],</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score_section_7'</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'امتیاز کلی مدیریت و رهبری بر حسب اندازه شرکت'</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"نمره"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    category_sort<span class="op">=</span>ordered_company_sizes</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="part06_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>